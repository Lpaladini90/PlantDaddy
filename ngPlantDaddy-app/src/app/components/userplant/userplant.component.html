<h1>{{ title }}</h1>

<div *ngIf="displayAddUserPlantForm == false && !selected" class="d-flex justify-content-center mx-4 mb-3 mb-lg-4">
  <button class="btn btn-primary btn-lg" (click)="displayAddUserPlantForm = true">Add a Plant to your Garden?</button>
</div>

<table class="table table-striped" *ngIf="!selected && displayAddUserPlantForm == false">
  <thead>
    <tr>
      <th scope="col">Nickname</th>
      <th scope="col">Height</th>
      <th scope="col">Spread</th>
      <th scope="col">Pot Diameter</th>
      <th scope="col">Home Location</th>
      <th scope="col">Description</th>
      <th scope="col">View</th>
      <th scope="col">Image URL</th>
    </tr>
  </thead>
  <tbody>
    <tr *ngFor="let userplant of userPlants">
      <td *ngIf="userplant.active === true">{{ userplant.nickname }}</td>
      <td *ngIf="userplant.active === true">{{ userplant.height }}</td>
      <td *ngIf="userplant.active === true">{{ userplant.spread }}</td>
      <td *ngIf="userplant.active === true">{{ userplant.potDiameter }}</td>
      <td *ngIf="userplant.active === true">{{ userplant.homeLocation }}</td>
      <td *ngIf="userplant.active === true">{{ userplant.description }}</td>
      <td *ngIf="userplant.active === true">
        <button class="btn btn-primary btn-lg" (click)="setPlant(userplant)">
          Details
        </button>
      </td>
      <td *ngIf="userplant.active === true">
        <img id="image" [src]="userplant.imageUrl" class="img-thumbnail" />
      </td>
    </tr>
  </tbody>
</table>

<div class="selectedPlant" *ngIf="selected">
  <br>
  <br>
  <br>
  <img class="selectedImage" [src]="selected.imageUrl"/>
  <br>
  <br>
  <ul class="list-group">
    <li class="list-group-item">ID: {{ selected.id }}</li>
    <li class="list-group-item">Nickname: {{ selected.nickname }}</li>
    <li class="list-group-item">Height: {{ selected.height }} inches</li>
    <li class="list-group-item">Spread: {{ selected.spread }} inches</li>
    <li class="list-group-item">Pot Diameter: {{ selected.potDiameter }} inches</li>
    <li class="list-group-item">Location:{{ selected.homeLocation }}</li>
    <p class="list-group-item">{{ selected.description }}</p>
  </ul>
  <br>
  <br>
  <br>
  <div *ngIf="selected.user.id == currentUserId">
    <div class="container">
      <div class="row">
        <div class="col-lg-3">
          <button class="btn btn-primary btn-lg" (click)="selectedReset(selected.id)">Back</button>
        </div>

        <div class="col-lg-3">
          <button class="btn btn-primary btn-lg" (click)="setEditUserPlant()">
            Edit
          </button>
        </div>

        <div class="col-lg-3">
          <button
            class="btn btn-primary btn-lg"
            (click)="displayPlantsTodos(selected.id); displayTodos = true"
          >
            Check Out {{ selected.nickname }} Todos
          </button>
        </div>

        <div class="col-lg-3">
          <button
            class="btn btn-primary btn-lg"
            (click)="
              deactivateUserPlant(selected, selected.id); selected = null
            "
          >
            Deactivate
          </button>
        </div>
      </div>
    </div>
  </div>
</div>






  <div *ngIf="displayTodos">
    <div>
      <div class="page-content page-container" id="page-content">
        <div class="padding">
          <div class="row">
            <div class="col-sm-8">
              <div class="container-fluid d-flex justify-content-center">
                <div
                  class="list list-row card"
                  id="sortable"
                  data-sortable-id="0"
                  aria-dropeffect="move"
                >
                  <button
                    class="btn btn-primary"
                    type="submit"
                    (click)="display = true"
                  >
                    Add A Todo
                  </button>

                  <div *ngFor="let todo of todos">
                    <div
                      class="list-item"
                      data-id="13"
                      data-item-sortable-id="0"
                      draggable="true"
                      role="option"
                      aria-grabbed="false"
                    >
                      <div>
                        <a data-abc="true"
                          ><span class="w-40 avatar gd-primary">P</span></a
                        >
                      </div>
                      <div class="flex">
                        <a class="item-author text-color" data-abc="true">{{
                          todo.name
                        }}</a>
                        <div class="item-except text-muted text-sm h-1x">
                          {{ todo.description }}
                        </div>
                        <div class="item-except text-muted text-sm h-1x">
                          {{ todo.dueDate }}
                        </div>
                        <div class="item-except text-muted text-sm h-1x">
                          {{ todo.active }}
                        </div>
                      </div>

                      <div class="no-wrap">
                        <div
                          class="item-date text-muted text-sm d-none d-md-block"
                        >
                          {{ todo.createdAt }}
                        </div>
                      </div>

                      <div>
                        <div class="item-action dropdown">
                          <a
                            data-toggle="dropdown"
                            class="text-muted"
                            data-abc="true"
                          >
                            <svg
                              xmlns="http://www.w3.org/2000/svg"
                              width="16"
                              height="16"
                              viewBox="0 0 24 24"
                              fill="none"
                              stroke="currentColor"
                              stroke-width="2"
                              stroke-linecap="round"
                              stroke-linejoin="round"
                              class="feather feather-more-vertical"
                            >
                              <circle cx="12" cy="12" r="1"></circle>
                              <circle cx="12" cy="5" r="1"></circle>
                              <circle cx="12" cy="19" r="1"></circle>
                            </svg>
                          </a>
                          <div
                            class="dropdown-menu dropdown-menu-right bg-black"
                            role="menu"
                          >
                            <a
                              class="dropdown-item"
                              data-abc="true"
                              (click)="displayTodo(todo)"
                              >See detail
                            </a>
                            <a
                              class="dropdown-item edit"
                              data-abc="true"
                              (click)="setEditTodo(todo)"
                              >Edit</a
                            >
                            <div class="dropdown-divider"></div>
                            <a
                              class="dropdown-item trash"
                              data-abc="true"
                              (click)="deleteTodo(todo.id)"
                              >Delete item</a
                            >
                          </div>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>

      <div *ngIf="selectedTodo">
        <ul>
          <li>{{ selectedTodo.id }}</li>
          <li>{{ selectedTodo.name }}</li>
          <li>{{ selectedTodo.description }}</li>
          <li>{{ selectedTodo.createdAt }}</li>
        </ul>

        <!-- <button class="btn btn-primary" type="submit" (click)="setEditTodo()">EDIT</button> -->
        <label for="task" class="form-label">Task</label>
      </div>

      <form #createForm="ngForm" *ngIf="editTodo && displaySubmit">
        <label for="name" class="form-label">Name: </label>
        <input type="text" name="name" [(ngModel)]="editTodo.name" />
        <br />
        <label for="description" class="form-label">Description: </label>
        <input
          type="text"
          name="description"
          [(ngModel)]="editTodo.description"
        />

        <button
          class="btn btn-primary"
          type="submit"
          (click)="updateTodo(editTodo.id, editTodo); displaySubmit = false"
        >
          Save Edit
        </button>
      </form>

      <form *ngIf="display" #createForm="ngForm" class="row g-3">
        <div class="col-md-6">
          <label for="inputEmail4" class="form-label">Task</label>
          <input type="text" name="name" [(ngModel)]="newTodo.name" />

          <label for="inputEmail4" class="form-label">User Plant Id</label>
          <input
            type="number"
            name="name"
            [(ngModel)]="newTodo.userPlants.id"
          />

          <br />

          <button
            class="btn btn-primary"
            (click)="addTodo(newTodo, newTodo.userPlants.id); display = false"
            type="submit"
          >
            Submit
          </button>
        </div>
      </form>
    </div>

    <div *ngIf="editUserPlant">
      <form>
        Nickname:
        <input
          type="text"
          name="nick name"
          [(ngModel)]="editUserPlant.nickname"
        />
        <br />
        Spread:
        <input type="number" name="spread" [(ngModel)]="editUserPlant.spread" />
        <br />
        Height:
        <input type="number" name="height" [(ngModel)]="editUserPlant.height" />
        <br />
        Pot Diameter:<input
          type="number"
          name="potDiameter"
          [(ngModel)]="editUserPlant.potDiameter"
        />
        <br />
        Home Location:
        <input
          type="text"
          name="home location"
          [(ngModel)]="editUserPlant.homeLocation"
        />
        <br />
        Description:
        <input
          type="text"
          name="description"
          [(ngModel)]="editUserPlant.description"
        />
        <br />
        Image URL:
        <input
          type="text"
          name="image url"
          [(ngModel)]="editUserPlant.imageUrl"
        />
        <br />
        <button (click)="updateUserPlant(editUserPlant, editUserPlant.id)">
          Save
        </button>
        <br />
        <button (click)="editUserPlant = null">Cancel</button>
        <br />
      </form>
    </div>
  </div>

  <div *ngIf="!selected && displayAddUserPlantForm == true">
    <section
      class="vh-100"
      id="registrationForm"
      style="background-color: #eee"
    >
      <div class="container h-100">
        <div class="row d-flex justify-content-center align-items-center h-100">
          <div class="col-lg-12 col-xl-11">
            <div class="card text-black" style="border-radius: 25px">
              <div class="card-body p-md-5">
                <div class="row justify-content-center">
                  <div class="col-md-10 col-lg-6 col-xl-5 order-2 order-lg-1">
                    <p
                      class="text-center h1 fw-bold mb-5 mx-1 mx-md-4 mt-4"
                    ></p>

                    <form class="mx-1 mx-md-4">
                      <div class="d-flex flex-row align-items-center mb-4">
                        <i class="fas fa-user fa-lg me-3 fa-fw"></i>
                        <div class="form-outline flex-fill mb-0">
                          <input
                            [(ngModel)]="newUserPlant.nickname"
                            type="text"
                            name="nickname"
                            class="form-control"
                          />
                          <label class="form-label" name="nickname">
                            Nickname</label
                          >
                        </div>
                      </div>

                      <div class="d-flex flex-row align-items-center mb-4">
                        <i class="fas fa-envelope fa-lg me-3 fa-fw"></i>
                        <div class="form-outline flex-fill mb-0">
                          <input
                            [(ngModel)]="newUserPlant.height"
                            type="number"
                            name="height"
                            class="form-control"
                          />
                          <label class="form-label" name="height">Height</label>
                        </div>
                      </div>

                      <div class="d-flex flex-row align-items-center mb-4">
                        <i class="fas fa-envelope fa-lg me-3 fa-fw"></i>
                        <div class="form-outline flex-fill mb-0">
                          <input
                            [(ngModel)]="newUserPlant.spread"
                            type="number"
                            name="spread"
                            class="form-control"
                          />
                          <label class="form-label" name="spread">Spread</label>
                        </div>
                      </div>

                      <div class="d-flex flex-row align-items-center mb-4">
                        <i class="fas fa-envelope fa-lg me-3 fa-fw"></i>
                        <div class="form-outline flex-fill mb-0">
                          <input
                            [(ngModel)]="newUserPlant.potDiameter"
                            type="number"
                            name="potDiameter"
                            class="form-control"
                          />
                          <label class="form-label" name="potDiameter"
                            >Pot Diameter</label
                          >
                        </div>
                      </div>

                      <div class="d-flex flex-row align-items-center mb-4">
                        <i class="fas fa-lock fa-lg me-3 fa-fw"></i>
                        <div class="form-outline flex-fill mb-0">
                          <input
                            [(ngModel)]="newUserPlant.homeLocation"
                            type="text"
                            name="homeLocation"
                            class="form-control"
                          />
                          <label class="form-label" name="homeLocation"
                            >Home Location</label
                          >
                        </div>
                      </div>

                      <div class="d-flex flex-row align-items-center mb-4">
                        <i class="fas fa-lock fa-lg me-3 fa-fw"></i>
                        <div class="form-outline flex-fill mb-0">
                          <!-- <input [(ngModel)]="newUserPlant.description" type="text" name="description" class="form-control" /> -->
                          <textarea
                            class="form-control"
                            rows="2"
                            name="description"
                            [(ngModel)]="newUserPlant.description"
                          ></textarea>
                          <!-- <input [(ngModel)]="newUserPlant.description" type="text" name="description" class="form-control" /> -->
                          <label class="form-label" name="description"
                            >Description</label
                          >
                        </div>
                      </div>

                      <div class="d-flex flex-row align-items-center mb-4">
                        <i class="fas fa-lock fa-lg me-3 fa-fw"></i>
                        <div class="form-outline flex-fill mb-0">
                          <label class="form-label" name="description"
                            >Plant Type:</label
                          >
                          <select
                            name="plantId"
                            class="form-select"
                            [(ngModel)]="newUserPlant.plant.id"
                          >
                            <option
                              *ngFor="let plant of plants"
                              value="{{ plant.id }}"
                            >
                              {{ plant.commonName }}
                            </option>
                          </select>
                        </div>
                      </div>

                      <div
                        class="d-flex justify-content-center mx-4 mb-3 mb-lg-4"
                      >
                        <button
                          (click)="addUserPlant(newUserPlant)"
                          type="button"
                          class="btn btn-primary btn-lg"
                        >
                          Add Plant
                        </button>
                      </div>

                      <div
                        class="d-flex justify-content-center mx-4 mb-3 mb-lg-4"
                      >
                        <button
                          class="btn btn-primary btn-lg"
                          type="submit"
                          name="submit"
                          value="Cancel"
                          (click)="displayAddUserPlantForm = false"
                        >
                          Cancel
                        </button>
                      </div>
                    </form>
                  </div>
                  <div
                    class="col-md-10 col-lg-6 col-xl-7 d-flex align-items-center order-1 order-lg-2"
                  >
                    <img
                      src="https://live.staticflickr.com/65535/52101246520_8a9e9ea24c_z.jpg"
                      class="img-fluid"
                      alt="Plant Daddy"
                    />
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </section>
  </div>
